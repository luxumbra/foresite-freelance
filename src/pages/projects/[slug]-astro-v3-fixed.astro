---
import { getCollection, getEntry } from 'astro:content';
import { Image } from 'astro:assets';

export async function getStaticPaths() {
  const projects = await getCollection('projects');
  return projects.map((project) => ({
    params: { slug: project.slug }
  }));
}

const { slug } = Astro.params;
const project = await getEntry('projects', slug);

if (!project) {
  throw new Error(`Project not found for slug: ${slug}`);
}
---

<html lang="en">
  <head>
    <title>{project.data.title}</title>
    <meta name="description" content={project.data.shortDescription} />
  </head>
  <body class="bg-zinc-900 text-white">
    <main class="max-w-3xl mx-auto px-6 py-12">
      <h1 class="text-4xl font-bold mb-2">{project.data.title}</h1>
      <p class="text-zinc-400 mb-4">{project.data.role}</p>

      {project.data.image && (
        <Image
          src={project.data.image}
          alt={project.data.title}
          width={1200}
          class="mb-6 rounded shadow"
        />
      )}

      <article class="prose prose-invert max-w-none">
        <project.Content />
      </article>

      <div class="mt-6 space-y-2">
        {project.data.github && (
          <p><a class="text-blue-400 hover:underline" href={project.data.github} target="_blank">GitHub →</a></p>
        )}
        {project.data.figma && (
          <p><a class="text-blue-400 hover:underline" href={project.data.figma} target="_blank">Figma →</a></p>
        )}
        {project.data.link && (
          <p><a class="text-blue-400 hover:underline" href={project.data.link} target="_blank">Live Site →</a></p>
        )}
      </div>
    </main>
  </body>
</html>
